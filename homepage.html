<html>
<head>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"/>
<link rel="stylesheet" type="text/css" href="homepage.css">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
<script src="bootbox.min.js"></script>
<script src="homepage.js"></script>

</head>
<body>
   <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
     <div class="container-fluid">
       <!-- Brand and toggle get grouped for better mobile display -->
       <div class="navbar-header">
         <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
           <span class="sr-only">Toggle navigation</span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
           <span class="icon-bar"></span>
         </button>
         <a class="navbar-brand" href="/"><img class="logo" src="assets/logo.png" /></a>
       </div>

       <!-- Collect the nav links, forms, and other content for toggling -->
       <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
         <ul class="nav navbar-nav">
           <li class="active"><a href="/">Home <span class="sr-only">(current)</span></a></li>
           <li><a href="profile.html">Profile</a></li>
           <li><a href="#">About</a></li>
           <li><a href="#">Contact Us</a></li>
         </ul>
         <form class="navbar-form navbar-left" role="search">
           <div class="form-group">
             <input type="text" class="form-control" placeholder="Search">
           </div>
           <button type="submit" class="btn btn-default">Submit</button>
         </form>
         <ul class="nav navbar-nav navbar-right">
           <li><a href="#">Log In</a></li>
           <li><a id="signUp" href="#">Sign Up</a></li>
         </ul>
       </div><!-- /.navbar-collapse -->
     </div><!-- /.container-fluid -->
   </nav>
   <header class="sb-page-header">
      <div class="container">
         <h1>ENDPOINT</h1>
         <h4>An integrated solution to finding the right technical candidate for the right technical job.</h4>
      </div>
   </header>
   <div id="main-content" class="container-fluid">
      <article>
            <div class="row">
               <div class="text-center">

                  <div class="col-md-4">
                     <div class="img-container">
                        <img src="assets/trophy.png" />
                     </div>
                  </div>
                  <div class="col-md-4">
                     <div class="img-container">
                        <img src="assets/rubiks.png" />
                     </div>
                  </div>
                  <div class="col-md-4">
                     <div class="img-container">
                        <img src="assets/handshake.png" />
                     </div>
                  </div>
               </div>
            </div>
            <div class="row">
               <div class="text-center">
                  <div class="col-md-4">
                     <h6>SHOWCASE YOUR SKILLSET</h6>
                  </div>
                  <div class="col-md-4">
                     <h6>PROVE YOURSELF TO RECRUITERS</h6>
                  </div>
                  <div class="col-md-4">
                     <h6>BUILD PROFESSIONAL RELATIONSHIPS</h6>
                  </div>
               </div>
            </div>

      </article>
   </div>

   <div id="signUpModal" class="modal fade" data-keyboard="true" data-backdrop="">
      <div class="modal-dialog">
         <div class="modal-content">
            <div class="modal-header">
               <button onclick="$('.skillsQuestions').empty()" type="button" class="close" data-dismiss="modal">&times;</button>
               <h4 class="modal-title" style="color: black;">Registration</h4>
            </div>
            <!-- dialog body -->
            <div class="modal-body">
               <div class="row">
                  <div class="form-group col-sm-12">
                     <input id="employerCheck" class="checkbox;left;" type="checkbox" autocomplete="off"></input>
                     <label class="center">I Am An Employer</label>
                  </div>
               </div>
              
                  <div class="row">
                     <div class="form-group col-lg-12">
                        <label>Username</label>
                        <input class="form-control" id="username"></input>
                     </div>
                  </div>
        
            
               <div class="row">
                  <div class="form-group col-lg-6">
                     <label><span class="userOptions">First </span> Name</label>
                     <input class="form-control" id ="fname"></input>
                  </div>
                <div class="userOptions">
                  <div class="form-group col-lg-6">
                     <label>Last Name</label>
                     <input class="form-control" id="lname"></input>
                  </div>
               </div>
               </div>
               <div class="row">
                  <div class="form-group col-lg-6">
                     <label>Email</label>
                     <input class="form-control" id="email"></input>
                  </div>
                  <div class="form-group col-lg-6">
                     <label>Confirm Email</label>
                     <input class="form-control"></input>
                  </div>
               </div>
               <div class="row">
                  <div class="form-group col-lg-6">
                     <label>Password</label>
                     <input class="form-control" type="password" id="password"></input>
                  </div>
                  <div class="form-group col-lg-6">
                     <label>Confirm Password</label>
                     <input class="form-control" type="password"></input>
                  </div>
               </div>
               <div class="row">
                  <div class="form-group col-lg-12">
                     <label>Address</label>
                     <input class="form-control" id="address"></input>
                  </div>
               </div>
               <div class="row">
                  <div class="form-group col-lg-6">
                     <label>City</label>
                     <input class="form-control" id="city"></input>
                  </div>
                  <div class="form-group col-lg-6">
                     <label>State</label>
                     <select class="form-control" id="state">
                         <option value="AL">Alabama</option>
                         <option value="AK">Alaska</option>
                         <option value="AZ">Arizona</option>
                         <option value="AR">Arkansas</option>
                         <option value="CA">California</option>
                         <option value="CO">Colorado</option>
                         <option value="CT">Connecticut</option>
                         <option value="DE">Delaware</option>
                         <option value="DC">District Of Columbia</option>
                         <option value="FL">Florida</option>
                         <option value="GA">Georgia</option>
                         <option value="HI">Hawaii</option>
                         <option value="ID">Idaho</option>
                         <option value="IL">Illinois</option>
                         <option value="IN">Indiana</option>
                         <option value="IA">Iowa</option>
                         <option value="KS">Kansas</option>
                         <option value="KY">Kentucky</option>
                         <option value="LA">Louisiana</option>
                         <option value="ME">Maine</option>
                         <option value="MD">Maryland</option>
                         <option value="MA">Massachusetts</option>
                         <option value="MI">Michigan</option>
                         <option value="MN">Minnesota</option>
                         <option value="MS">Mississippi</option>
                         <option value="MO">Missouri</option>
                         <option value="MT">Montana</option>
                         <option value="NE">Nebraska</option>
                         <option value="NV">Nevada</option>
                         <option value="NH">New Hampshire</option>
                         <option value="NJ">New Jersey</option>
                         <option value="NM">New Mexico</option>
                         <option value="NY">New York</option>
                         <option value="NC">North Carolina</option>
                         <option value="ND">North Dakota</option>
                         <option value="OH">Ohio</option>
                         <option value="OK">Oklahoma</option>
                         <option value="OR">Oregon</option>
                         <option value="PA">Pennsylvania</option>
                         <option value="RI">Rhode Island</option>
                         <option value="SC">South Carolina</option>
                         <option value="SD">South Dakota</option>
                         <option value="TN">Tennessee</option>
                         <option value="TX">Texas</option>
                         <option value="UT">Utah</option>
                         <option value="VT">Vermont</option>
                         <option value="VA">Virginia</option>
                         <option value="WA">Washington</option>
                         <option value="WV">West Virginia</option>
                         <option value="WI">Wisconsin</option>
                         <option value="WY">Wyoming</option>
                     </select>
                  </div>
               </div>
               <div class="row">
                  <div class="form-group col-lg-6">
                     <label>Zip Code</label>
                     <input class="form-control" id="zip"></input>
                  </div>
                  <div class="form-group col-lg-6"></div>
               </div>

                <div class="userOptions">
                  <div class="row">
                     <div class="form-group col-lg-6">
                     <label>Technical Skills</label>
                     <input class="form-control skillValue" placeholder="Java"></input>
                     </div>
                     <div class="form-group col-lg-6">
                     <label>Proficiency level</label>
                     <select class="form-control proficiencyLevel">
                     <option value ="10">Proficient</option>
                     <option value="6">Average</option>
                     <option value="3">Familiar</option>
                     </select>

                     </div>

                  </div> 
               </div>

               <div class="skillsQuestions">
               </div>

                <button class="btn btn-info userOptions " onclick="appendSkills()">Add Additional Skill</button>
                <br>
                <br>

               <div class="row">
                     <div class="form-group col-lg-12">
                     <label><span class="userOptions">Personal </span>Website</label>
                     <input class="form-control" id="website"></input>
                     </div>
               </div>
               <div class="userOptions">
                  <div class="row">
                     <div class="form-group col-lg-12">
                     <label>GitHub link (optional, but IMPORTANT)</label>
                     <input class="form-control" id="github" placeholder="https://github.com/user"></input>
                     </div>
                  </div>
                  <div class="row">
                     <div class="form-group col-lg-12">
                     <label>Stack Exchange Profile link (optional, but IMPORTANT)</label>
                     <input class="form-control" id="stackoverflow" placeholder="http://stackoverflow.com/users/xxxxxxx/userxxxxxxx"></input>
                     </div>
                  </div>
                  <div class="row">
                     <div class="form-group col-lg-12">
                     <label>Resume Link</label>
                     <input class="form-control" placeholder="http://drive.google.com/resume.pdf" id="resume"></input>
                     </div>
                  </div>
               </div>
            </div>
            <!-- dialog buttons -->
            <div class="modal-footer"><button onclick="$('.skillsQuestions').empty()" id="cancelModal" type="button" class="btn btn-secondary">cancel</button><button type="button" class="btn btn-primary" onclick="insertDatabase()">Submit</button></div>

         </div>
      </div>
   </div>

   <footer class="footer">
      <div class="container">
         
      </div>
   </footer>
   <script>

   function createSkills()
   {
    var skill=$("<div class='userOptions'><div class='row'><div class='form-group col-lg-6'><label>Technical Skills</label> <input class='form-control skillValue' placeholder='Java'></input> </div><div class='form-group col-lg-6'><label>Proficiency level</label><select class='form-control proficiencyLevel'><option value ='10'>Proficient</option> <option value='6'>Average</option><option value='3'>Familiar</option></select></div> </div></div>");
   
    $('.skillsQuestions').append(skill);
   }

   
   function appendSkills(){

    createSkills();

   }


   
   function insertDatabase()
   {


      var stackoverflow = document.getElementById("stackoverflow").value;
      var github = document.getElementById("github").value;
      var usertype;

      if (jQuery("#employerCheck").prop("checked"))
      {
         usertype = "company";
      }
      else
      {
         usertype = "applicant";
      }

      var idIndex= stackoverflow.indexOf("users/");
      var str = stackoverflow.substring(idIndex+6);
      var nextSlash = str.indexOf("/");

      var idNumber = parseInt(str.substring(0,nextSlash));

      if(isNaN(idNumber))
         idNumber = -1;
     


      var test = $(".skillValue");
      // console.log(test[0].value);
      var test2 = $(".proficiencyLevel");
      var testObj = [];
      for (var i = 0; i < test.length; i++)
      {
        var obj = {skillValue: test[i].value, proficiencyLevel: test2[i].value};

        testObj.push(obj);
      }
      // console.log(testObj);
      var username = document.getElementById("username").value;
      var fname = document.getElementById("fname").value;
      var lname = document.getElementById("lname").value;
      var email = document.getElementById("email").value;
      var password = document.getElementById("password").value;
      var address = document.getElementById("address").value;
      var city = document.getElementById("city").value;
      var state = document.getElementById("state").value;
      var zip = parseInt(document.getElementById("zip").value);
      if(isNaN(zip))
        zip = -1;
      var website = document.getElementById("website").value;

      // Validation later

      // Hash password later
      var data = {username:username,
                  usertype:usertype,
                  fname:fname,
                  lname:lname,
                  email:email,
                  password:password,
                  address:address,
                  city:city,
                  state:state,
                  zip:zip,
                  website:website,
                  skills:testObj,
                  stackoverflow:idNumber,
                  githubUser:github
                  };


       jQuery.ajax({
        type: "POST",
        url: "/hackpsu/insert",
        data: data,
    
        success: function(data){
         // return true;
         if(data.status == 200)
         {
           jQuery("#signUpModal").hide();
           bootbox.dialog({
            message: "Thank you for submitting the form",
            title: "Form submitted",
            buttons: {
            success: {
                label: "Continue",
                className: "btn-primary btn-info",
                callback: function() {

                   window.location.href = "/profile/"+username;

                  }
              },
            }

           });
        }

     },
     error: function(data){
         // return false;
         alert('Error! There was an error ' + JSON.stringify(data));
        }
    });


   }


   </script>
</body>
</html>